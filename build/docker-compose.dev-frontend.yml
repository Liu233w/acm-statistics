version: '3'

services:
  # 只有前端支持 hot reload，所以只改动前端
  frontend:
    image: acm-statistics-node-base
    working_dir: /var/project/frontend
    volumes:
    - ..:/var/project
    environment:
    - NODE_ENV=development
    command: sh -c "npm run dev"
    labels:
      # 不加上这一条就没法被 traefik 识别，暂时还不知道是怎么回事
      # TODO: 修复这个问题
      traefik.backend: frontend:3000

  crawler-api-backend:
    environment:
    # 显示后端详细日志
    - NODE_ENV=development

  watchtower:
    # skip watchtower in development
    image: tianon/true
    command: ''
