version: '3'

services:

  frontend:
    image: ${DOCKER_REPO}acm-statistics-frontend${DOCKER_TAG}
    environment:
    - HOST=0.0.0.0
    ports:
    - "${EXPOSE_PORT}:3000"

  crawler-api-backend:
    image: ${DOCKER_REPO}acm-statistics-crawler-api-backend${DOCKER_TAG}
    environment:
    - ACM_STATISTICS_CRAWLER_ENV:crawlers:vjudge:crawler_login_user="${VJUDGE_USERNAME}"
    - ACM_STATISTICS_CRAWLER_ENV:crawlers:vjudge:crawler_login_password="${VJUDGE_PASSWORD}"

  watchtower:
    # 这个项目比 watchtower 更好用一些，便于以后更新 NOTIFIER
    image: pyouroboros/ouroboros
    volumes:
    - /var/run/docker.sock:/var/run/docker.sock
    environment:
    # 半小时更新一次
    - CRON=*/30 * * * *
    - CLEANUP=true
    - SELF_UPDATE=true
